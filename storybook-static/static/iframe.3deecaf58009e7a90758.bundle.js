(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{739:function(n,e,t){t(244),t(740),n.exports=t(741)},741:function(n,e,t){"use strict";t.r(e),function(n){var e=t(242);Object(e.configure)(function(){t(753)},n)}.call(this,t(343)(n))},753:function(n,e,t){"use strict";t.r(e);var r=t(66),o=t.n(r),a=t(734),i=t.n(a),u=t(9),s=t.n(u),c=t(23),p=t.n(c),l=t(24),m=t.n(l),d=t(25),f=t.n(d),v=t(18),g=t.n(v),h=t(6),C=t.n(h),w=t(57),x=t.n(w),y=t(58),b=t.n(y),R=t(218),S=t.n(R),A=t(0),P=t.n(A),E=t(735),D=t.n(E),j=t(242),k=(t(224),t(67)),O=t(101),L=t(738),T=t.n(L);t(1029);function U(){var n=b()(["\n    flex-shrink: 1;\n"]);return U=function(){return n},n}function W(){var n=b()(["\n    flex-grow: 1;\n"]);return W=function(){return n},n}function I(){var n=b()(["\n    flex-grow: 1;\n"]);return I=function(){return n},n}function M(){var n=b()(["\n    height: fill-available;\n    object-fit: contain;\n    object-position: top;\n"]);return M=function(){return n},n}function H(){var n=b()(["\n    flex-direction: column\n"]);return H=function(){return n},n}function B(){var n=b()(["\n    display: flex;\n"]);return B=function(){return n},n}function J(){var n=b()(["\n    border:0 none;\n    clip:rect(0px,0px,0px,0px);\n    height:1px;\n    margin:-1px;\n    overflow:hidden;\n    padding:0;\n    position:absolute;\n    width:1px\n"]);return J=function(){return n},n}function N(){var n=b()(["\n    font-size: 50px;\n    display: flex;\n    align-items: center;\n"]);return N=function(){return n},n}function V(){var n=b()(["\n    color: gray;\n"]);return V=function(){return n},n}function q(){var n=b()(["\n    color: gold;\n"]);return q=function(){return n},n}var F=P.a.createElement,_=function(n){return function(e){return new Promise(function(t){return setTimeout(function(){return t(e)},n)})}},z=function(){return{name:Object(O.text)("name","Francine Periwinkle's Peticoat Blues"),rating:Object(O.number)("rating",3)}},G=k.a.i(q()),Q=k.a.i(V()),Y=function(n){var e=n.active;return F(e?G:Q,{},"★")},K=k.a.div(N()),X=k.a.input(J()),Z=function(n){var e=n.rating,t=n.starCount,r=void 0===t?5:t;return P.a.createElement(X,{type:"range",min:0,max:r,value:e,readOnly:!0})},$=function(n){var e=n.rating,t=n.starCount,r=void 0===t?5:t;return F.apply(void 0,[K,null,F(Z,{rating:e,starCount:r})].concat(x()(function(n){return S.a.mark(function e(t){var r;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<n)){e.next=7;break}return e.next=4,t(r);case 4:r++,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})}(r)(function(n){return F(Y,{active:n<e})}))))},nn=function(n){var e=n.name,t=n.rating;return P.a.createElement("figure",null,P.a.createElement("figcaption",null,e),P.a.createElement($,{rating:t,starCount:5}))},en=function(n){var e=n.value,t=n.render;return e?t(e):"Please Wait..."},tn=function(n){function e(){var n,t;s()(this,e);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=p()(this,(n=m()(e)).call.apply(n,[this].concat(o))),C()(g()(g()(t)),"render",function(){return P.a.createElement(en,{value:t.state,render:function(n){return P.a.createElement(nn,n.review)}})}),C()(g()(g()(t)),"componentDidUpdate",function(){var n=i()(S.a.mark(function n(e){var r;return S.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e||t.props.id!==e.id){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.props.api.getReviews(t.props.id);case 4:r=n.sent,t.setState({review:r});case 6:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()),C()(g()(g()(t)),"componentDidMount",function(){return t.componentDidUpdate()}),t}return f()(e,n),e}(P.a.Component);Object(j.storiesOf)("Presentation").addDecorator(O.withKnobs).add("Intro",function(){return un(on("\n            # React Context, Storybook and Other Tips\n\n            ## George Mauer - @togakangaroo\n\n            **I just wrote this!**\n\n            [Code is here](https://github.com/togakangaroo/react-context-storybook/tree/master)\n\n            [View this online here](http://georgemauer.net/react-context-storybook/storybook-static)\n        "))}).add("A common problem",function(){return un(on("\n            # A Common Problem\n\n            I want to create a component that hits an api\n        "))}).add("Basic direct query component",function(){return un(on("\n            # Tip: All Components Should Either Do Stuff Or Render Stuff, **Not** Both\n        "),an("\n            const ReviewSummary = ({name, rating}) => (\n                <figure>\n                    <figcaption>{name}</figcaption>\n                    <StarRating rating={rating} starCount={5} />\n                </figure>\n            )\n\n            const DirectQueryLoadedReviewSummary = class extends React.Component {\n                render = () => (\n                    {!this.state ? \"Please Wait\" : (\n                        <ReviewSummary {...this.state.review}/>\n                    )} />\n                )\n                componentDidUpdate = async (prevProps) => {\n                    if(prevProps && (this.props.id === prevProps.id))\n                        return\n                    const review = await fetch('/api/reviews' + this.props.id).then(x => x.json())\n                    this.setState({review})\n                }\n                componentDidMount = () => this.componentDidUpdate()\n            }\n        "))}).add("Create When",function(){return un(on("\n            # Tip: Create a `When` component\n        "),an("\n            const When = ({value, render}) => (\n                value ? render(value) : `Please Wait...`\n            )\n        "))}).add("Use When",function(){return un(on("\n            # Tip: Create a `When` component\n        "),an("\n            const When = ({value, render}) => (\n                value ? render(value) : `Please Wait...`\n            )\n        "),an("\n            const DirectQueryLoadedReviewSummary = class extends React.Component {\n                render = () => (\n                    <When value={this.state} render={s => (\n                        <ReviewSummary {...s.review}/>\n                    )} />\n                )\n                componentDidUpdate = async (prevProps) => {\n                    if(prevProps && (this.props.id === prevProps.id))\n                        return\n                    const review = await fetch('/api/reviews' + this.props.id).then(x => x.json())\n                    this.setState({review})\n                }\n                componentDidMount = () => this.componentDidUpdate()\n            }\n        "))}).add("Stub the entire Api method",function(){return un(on("\n            # Tip: Stub the entire Api method\n        "),an("\n            const ApiLoadedReviewSummary = class extends React.Component {\n                render = () => (\n                    <When value={this.state} render={s => (\n                        <ReviewSummary {...s.review}/>\n                    )} />\n                )\n                componentDidUpdate = async (prevProps) => {\n                    if(prevProps && (this.props.id === prevProps.id))\n                        return\n                    const review = await this.props.api.getReviews(this.props.id)\n                    this.setState({review})\n                }\n                componentDidMount = () => this.componentDidUpdate()\n            }\n        "),on("\n            But how to actually pass down that `api` property?\n        "))}).add("Context Demo",function(){var n=P.a.createContext(null);return un(on("\n                # Create a React Context\n            "),an("\n                const DemoContext = React.createContext(null)\n            "),on("\n                ## Usage\n            "),an("\n                const DemoConsumer = () => (\n                    <DemoContext.Consumer>{(value) =>\n                        <i>Our value: {value}</i> \n                    }</DemoContext.Consumer>\n                )\n            "),an('\n                <DemoContext.Provider value={text("provided value", "abc")}>\n                    <figure>\n                        <figcaption>Any amount of items in between these</figcaption>\n                        <Demo />\n                    </figure>\n                </DemoContext.Provider>\n            '),on("\n                That's it!\n            "),P.a.createElement(n.Provider,{value:Object(O.text)("provided value","abc")},P.a.createElement("figure",null,P.a.createElement("figcaption",null,"Any amount of items in between these"),P.a.createElement(function(){return P.a.createElement(n.Consumer,null,function(n){return P.a.createElement("i",null,"Our value: ",n)})},null))),on("\n                (Also, knobs is pretty cool check out the knobs panel below ↓)\n            "))}).add("Static Scoping",function(){return un(on("\n            # Javascript Has Static / Lexical Scope\n\n            **Interview question time!**\n        "),an("\n            let a = 1\n            let b = 2\n\n            const fn2 = () => {\n                a = 3\n            }\n\n            const fn1 = () => {\n                let a = 4\n                b = 3\n                fn2()\n            }\n\n            fn1(a)\n\n            console.log(a) // 3\n            console.log(b) // 3\n        "))}).add("Dynamic Scoping",function(){return un(on("\n            # Dynamic Scoping\n\n            * Rarer\n            * Can make things incredibly extensible\n        "),P.a.createElement("figure",{style:{display:"flex",alignItems:"flex-start"}},P.a.createElement(ln,null,an("\n                let a = 1\n                let b = 2\n\n                const fn2 = () => {\n                    a = 3\n                }\n\n                const fn1 = () => {\n                    let a = 4\n                    b = 3\n                    fn2()\n                }\n\n                fn1()\n\n                console.log(a) // 1\n                console.log(b) // 3\n              ")),P.a.createElement(dn,{src:"/dynamic_scoping.png",style:{width:"40%"}})))}).add("Opt-in Dynamic Scoping",function(){return un(P.a.createElement(cn,null,on("\n                # Dynamic Scoping is Confusing\n\n                But Opt-In dynamic scoping...is _awesome_\n            "),P.a.createElement(mn,{src:"trex-samurai.jpg"})))}).add("Context With Api",function(){var n=P.a.createContext(null);return un(on("\n                # Create a React Context\n            "),an("\n                const ApiContext = React.createContext(null)\n            "),on("\n                ## Usage\n            "),an("\n                <ApiContext.Provider value={{getReviews: () => Promise.resolve(stubReview())}}>\n                    <ApiContext.Consumer>{(api) =>\n                        <ApiLoadedReviewSummary api={api} id={123} />\n                    }</ApiContext.Consumer>\n                </ApiContext.Provider>\n            "),P.a.createElement(n.Provider,{value:{getReviews:function(){return Promise.resolve(z())}}},P.a.createElement(n.Consumer,null,function(n){return P.a.createElement(tn,{api:n,id:123})})))}).add("Without providers",function(){var n=P.a.createContext({getReviews:function(){return Promise.resolve(z())}});return un(on("\n                # Setting Providers is a Pain\n\n                So provide a default value instead.\n            "),an("\n                const ApiContext = React.createContext({\n                    getReviews: Promise.resolve(stubReview())\n                })\n            "),on("\n                ## Usage\n            "),an("\n                <ApiContext.Consumer>{(api) =>\n                    <ApiLoadedReviewSummary api={api} id={123} />\n                }</ApiContext.Consumer>\n            "),P.a.createElement(n.Consumer,null,function(n){return P.a.createElement(tn,{api:n,id:123})}))}).add("Create HoC",function(){var n=P.a.createContext({getReviews:function(){return Promise.resolve(z())}}),e=function(e){return function(t){return P.a.createElement(n.Consumer,null,function(n){return P.a.createElement(e,o()({api:n},t))})}}(tn);return un(on("\n                # Tip: Create an ApiContext Higher Order Component (HoC)\n            "),an("\n                const withApiContext = (Component) => (props) => (\n                    <ApiContext.Consumer>{(api) =>\n                        <Component api={api} {...props} />\n                    }</ApiContext.Consumer>\n                )\n            "),an("\n                const LoadedReviewSummary = withApiContext(ApiLoadedReviewSummary)\n            "),on("\n                Can now be used transparently\n            "),an("\n                <LoadedReviewSummary id={456} />\n            "),P.a.createElement(e,{id:456}))}).add("Delayed Promise Resolver",function(){var n=P.a.createContext({getReviews:function(){return _(Object(O.number)("Loading delay",5e3))(z())}}),e=function(e){return function(t){return P.a.createElement(n.Consumer,null,function(n){return P.a.createElement(e,o()({api:n},t))})}}(tn);return un(on("\n                # Tip: Create a Promise Reolver You Can Control\n\n                To test what what it looks like while loading\n            "),an('\n                const resolveIn = ms => value => new Promise(resolve =>\n                    setTimeout(() => resolve(value), ms)\n                )\n                const ApiContext = React.createContext({\n                    getReviews: () => resolveIn(number("Loading delay", 5000))(stubReview())\n                })\n            '),an("\n                <LoadedReviewSummary id={456} />\n            "),P.a.createElement(e,{id:456}))}).add("Maybe not Jsx",function(){return un(on("\n            # Tip: You don't *always* need Jsx\n\n            Some things are significantly easier without it\n        "),an('\n            const ActiveStar = styled.i`\n                color: gold;\n            `\n            const InactiveStar = styled.i`\n                color: gray;\n            `\n\n            const Star = ({active}) => create(active ? ActiveStar : InactiveStar, {}, `★`)\n\n            const StarRatingContainer = styled.div`\n                font-size: 50px;\n                display: flex;\n                align-items: center;\n            `\n            const HiddenInput = styled.input`\n                border:0 none;\n                clip:rect(0px,0px,0px,0px);\n                height:1px;\n                margin:-1px;\n                overflow:hidden;\n                padding:0;\n                position:absolute;\n                width:1px\n            `\n            const StarRatingInput = ({rating, starCount=5}) => (\n                <HiddenInput type="range" min={0} max={starCount} value={rating} readOnly={true} />\n            )\n\n            const create = React.CreateElement\n            const StarRating = ({rating, starCount=5}) =>\n                create(StarRatingContainer, null,\n                    create(StarRatingInput, {rating, starCount}),\n                        ...repeat(starCount)(i => create(Star, {active: i < rating}))\n                )\n\n            const ReviewSummary = ({name, rating}) => (\n                <figure>\n                    <figcaption>{name}</figcaption>\n                    <StarRating rating={rating} starCount={5} />\n                </figure>\n        '))}).add("Auto unmount",function(){var n=P.a.createContext({getReviews:function(){return _(Object(O.number)("Loading delay",5e3))(z())}}),e=function(n,e){var t=e.beforeCompletion;return new Promise(function(e,r){return n.then(t(e),t(r))})},t=function(n,e){return Object.fromEntries(n.map(function(n){return[n,function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(void 0,[n].concat(r))}]}))},r=function(){for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return function(r){return function(i){function u(){var i,c;s()(this,u);for(var l=arguments.length,d=Array(l),f=0;f<l;f++)d[f]=arguments[f];return c=p()(this,(i=m()(u)).call.apply(i,[this].concat(d))),C()(g()(g()(c)),"render",function(){return P.a.createElement(n.Consumer,null,function(n){var i=t(a,function(t){for(var r=arguments.length,o=Array(1<r?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return e(n[t].apply(n,o),{beforeCompletion:c.ifMounted})});return P.a.createElement(r,o()({api:i},c.props))})}),C()(g()(g()(c)),"ifMounted",function(n){return function(){return!c.isUnmounted&&n.apply(void 0,arguments)}}),C()(g()(g()(c)),"componentWillUnmount",function(){c.isUnmounted=!0}),c}return f()(u,i),u}(P.a.Component)}}("getReviews")(tn);return un(on("\n                # More Complex Things\n\n                With our `withApiContext` HoC we now have hooks to do other interesting things\n\n                * Let's force people to be explicit about what apis they want to use\n                * Let's never resolve any promises if our HoC is unmounted\n\n                Do this by creating a new api object to pass down to the component. This will only have the functions requested and\n                proxy the promise with its own version that will only resolve if the component is not mounted\n            "),an('\n                const ApiContext = React.createContext({\n                    getReviews: () => resolveIn(number("Loading delay", 5000))(stubReview())\n                })\n\n                const proxyPromise = (promise, {beforeCompletion}) => new Promise((resolve, reject) =>\n                    promise.then(beforeCompletion(resolve), beforeCompletion(reject))\n                )\n                const propsToObject = (props, createValue) =>\n                        Object.fromEntries(props.map(prop => [prop, (...args) => createValue(prop, ...args)]))\n\n                const withApiContext = (...apiPropNames) => (Component) =>\n                        class extends React.Component {\n                            render = () => (\n                                <ApiContext.Consumer>{(contextApi) => {\n                                    const api = propsToObject(apiPropNames,\n                                    (prop, ...args) => proxyPromise(contextApi[prop](...args), {beforeCompletion: this.ifMounted})\n                                    )\n                                    return (\n                                        <Component api={api} {...this.props} />\n                                    )\n                                }}</ApiContext.Consumer>\n                            )\n                            ifMounted = fn => (...args) => !this.isUnmounted && fn(...args)\n                            componentWillUnmount = () => {\n                                this.isUnmounted = true\n                            }\n                        }\n                const LoadedReviewSummary = withApiContext("getReviews")(ApiLoadedReviewSummary)\n            '),Object(O.boolean)("currently mounted",!0)?P.a.createElement(r,{id:123}):null)}).add("Storybook",function(){return un(on('\n            # Thoughts on [Storybook](https://storybook.js.org/)\n\n            * Very powerful "playground" tool - REPL-Driven-Development\n            * Fast to set up for standard architectures\n            * Great for component gallery\n            * Can do some of what TDD does\n\n            **Also**\n\n            * Clearly this presentation is cool\n       '))});var rn=function(n){var e=n.split("\n")[1],t=/^\s*/.exec(e)[0];return n.replace(new RegExp("\n".concat(t),"g"),"\n").trim()},on=function(n){return F(D.a,{source:rn(n)})},an=function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"javascript";return F(T.a,{className:e},rn(n))},un=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];return F.apply(void 0,[P.a.Fragment,null].concat(e))},sn=k.a.div(B()),cn=Object(k.a)(sn)(H()),pn=k.a.img(M()),ln=k.a.div(I()),mn=Object(k.a)(pn)(W()),dn=Object(k.a)(pn)(U())}},[[739,3,2]]]);
//# sourceMappingURL=iframe.3deecaf58009e7a90758.bundle.js.map